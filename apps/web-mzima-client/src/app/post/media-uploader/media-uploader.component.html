<div class="media-loader">
  <div class="media-loader__btn">
    <div class="media-loader__preview" *ngIf="mediaFiles.length > 0">
      <!-- <div class="media-loader__preview-images" *ngIf="media === 'image'">
        <div class="media-preview image {{mediaFile.status}}" *ngFor="let mediaFile of mediaFiles; let i = index">
          <img class="thumbnail" [src]="mediaFile.preview" />
          <div class="media-details">
            <div class="filename">{{ getFileName(mediaFile) }}</div>
            <div class="filesize">{{ getFileSize(mediaFile) }}</div>
          </div>
          <div class="status-button" (click)="clickStatusButton(i)">
            <mat-icon class="xicon" icon svgIcon="close"></mat-icon>
          </div>
        </div>
      </div>
      <div class="media-loader__preview-audio" *ngIf="media === 'audio'">
        <div class="media-preview audio {{mediaFile.status}}" *ngFor="let mediaFile of mediaFiles; let i = index">
          <audio controls [src]="mediaFile.preview"></audio>
          <div class="status-button" (click)="clickStatusButton(i)">
            <mat-icon class="xicon" icon svgIcon="close"></mat-icon>
          </div>
        </div>
      </div>
      <div class="media-loader__preview-documents" *ngIf="media === 'document'">
        <div class="media-preview document {{mediaFile.status}}" *ngFor="let mediaFile of mediaFiles; let i = index">
          <ng-template [ngIf]="mediaFile.status === 'ready' || mediaFile.status === 'uploaded'" [ngIfElse]="inProgress">
            <img class="thumbnail" [src]="getDocumentThumbnail(mediaFile)" />
            <div class="media-details">
              <div class="filename">{{ getFileName(mediaFile) }}</div>
              <div class="filesize">{{ getFileSize(mediaFile) }}</div>
            </div>
          </ng-template>
          <ng-template #inProgress>
            <div class="media-blank">
              <mat-icon *ngIf="mediaFile.status === 'error'" class="xicon" icon svgIcon="warning"></mat-icon>
              <app-spinner *ngIf="mediaFile.status === 'uploading'"/>
            </div>
            <div class="media-status"></div>
          </ng-template>
          <div class="status-button" (click)="clickStatusButton(i)">
            <ng-template [ngIf]="mediaFile.status === 'ready'" [ngIfElse]="cross">
              <mat-icon class="xicon" icon svgIcon="check"></mat-icon>
            </ng-template>
            <ng-template #cross>
              <mat-icon class="xicon" icon svgIcon="close"></mat-icon>
            </ng-template>
          </div>
        </div>
      </div> -->
      <div class="media-loader__preview-{{ media }}">
        <div
          class="media-preview {{ media }} {{ mediaFile.status }}"
          *ngFor="let mediaFile of mediaFiles; let i = index"
        >
          <ng-template
            [ngIf]="mediaFile.status === 'ready' || mediaFile.status === 'uploaded'"
            [ngIfElse]="inProgress"
          >
            <img
              *ngIf="media === 'document'"
              class="thumbnail"
              [src]="getDocumentThumbnail(mediaFile)"
            />
            <img *ngIf="media === 'image'" class="thumbnail" [src]="mediaFile.preview" />
            <audio *ngIf="media === 'audio'" controls [src]="mediaFile.preview"></audio>
            <div class="media-details">
              <div class="filename">{{ getFileName(mediaFile) }}</div>
              <div class="filesize">{{ getFileSize(mediaFile) }}</div>
            </div>
          </ng-template>
          <ng-template #inProgress>
            <div class="media-blank">
              <mat-icon
                *ngIf="mediaFile.status === 'error'"
                class="xicon"
                icon
                svgIcon="warning"
              ></mat-icon>
              <app-spinner *ngIf="mediaFile.status === 'uploading'"></app-spinner>
            </div>
            <div class="media-status"></div>
          </ng-template>
          <div class="status-button" (click)="clickStatusButton(i)">
            <ng-template [ngIf]="mediaFile.status === 'ready'" [ngIfElse]="cross">
              <mat-icon class="xicon" icon svgIcon="check"></mat-icon>
            </ng-template>
            <ng-template #cross>
              <mat-icon class="xicon" icon svgIcon="close"></mat-icon>
            </ng-template>
          </div>
        </div>
      </div>
    </div>
    <div class="media-loader__controls">
      <mzima-client-button
        fill="outline"
        color="secondary"
        [disabled]="maxFiles !== -1 && this.mediaFiles.length < maxFiles"
        class="media-loader__control"
        (buttonClick)="fileInput.click()"
        [data-qa]="'btn-post-item-upload'"
        [ngSwitch]="mediaType"
      >
        {{ mediaType.buttonText | translate }}
        <mat-icon>{{ mediaType.icon }}</mat-icon>
      </mzima-client-button>
      <input
        hidden
        #fileInput
        multiple
        type="file"
        accept="{{ mediaType.fileTypes }}"
        (change)="onFileSelected($event)"
      />
    </div>

    <mat-error class="error-msg" *ngIf="error !== 'none'">
      {{ error | translate }}
    </mat-error>
  </div>
</div>
